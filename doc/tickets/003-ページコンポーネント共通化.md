# Ticket #003: ページコンポーネント共通化

## 概要
複数のページコンポーネントで類似したボイラープレートコードが重複している問題を解決するため、共通レイアウトコンポーネントを作成する。

## 背景
jscpdによるコピペ検出で以下のページ間重複が検出された：

### 重複パターン1: ページ基本構造
- `app/debug/page.tsx:25-42` ↔ `app/management/page.tsx:21-38` (17行, 135トークン)
- `app/chat/page.tsx:10-39` ↔ `components/recent-lines-footer.tsx:5-48` (29行, 174トークン)
- `app/page.tsx:10-46` ↔ `components/recent-lines-footer.tsx:5-46` (36行, 200トークン)

### 重複パターン2: ページレイアウト構造
- `app/branch_list/page.tsx:7-42` ↔ `app/chat/page.tsx:8-52` (35行, 206トークン)
- `app/page.tsx:58-101` ↔ `app/chat/page.tsx:65-108` (43行, 431トークン)

## 目標
- ページコンポーネント間の重複を排除
- 一貫したページレイアウト構造を確立
- メンテナンス性の向上

## 実装タスク

### 1. 共通ページレイアウトコンポーネント作成

**ファイル**: `components/layouts/PageLayout.tsx`

**実装内容**:
```typescript
import { ReactNode } from 'react'

interface PageLayoutProps {
  title?: string
  children: ReactNode
  footer?: ReactNode
  sidebar?: ReactNode
}

export function PageLayout({ title, children, footer, sidebar }: PageLayoutProps) {
  return (
    <div className="min-h-screen bg-background">
      {title && (
        <header className="border-b">
          <div className="container mx-auto px-4 py-6">
            <h1 className="text-2xl font-bold">{title}</h1>
          </div>
        </header>
      )}

      <main className="container mx-auto px-4 py-6">
        <div className="flex gap-6">
          <div className="flex-1">
            {children}
          </div>
          {sidebar && (
            <aside className="w-80">
              {sidebar}
            </aside>
          )}
        </div>
      </main>

      {footer && (
        <footer className="border-t mt-auto">
          {footer}
        </footer>
      )}
    </div>
  )
}
```

### 2. チャット専用レイアウトコンポーネント作成

**ファイル**: `components/layouts/ChatLayout.tsx`

**実装内容**:
```typescript
import { ReactNode } from 'react'
import { PageLayout } from './PageLayout'

interface ChatLayoutProps {
  children: ReactNode
  sidebar?: ReactNode
}

export function ChatLayout({ children, sidebar }: ChatLayoutProps) {
  return (
    <PageLayout sidebar={sidebar}>
      <div className="space-y-4">
        {children}
      </div>
    </PageLayout>
  )
}
```

### 3. 既存ページの修正

**対象ファイル**:
- `app/page.tsx`
- `app/chat/page.tsx`
- `app/branch_list/page.tsx`
- `app/debug/page.tsx`
- `app/management/page.tsx`

**修正方針**:
1. 重複しているレイアウトコードを削除
2. 適切なレイアウトコンポーネントを import
3. JSX構造を簡素化

**例: app/chat/page.tsx の修正後**:
```typescript
import { ChatLayout } from '@/components/layouts/ChatLayout'
import { BranchingChatUI } from '@/components/branching-chat-ui'
import { RecentLinesFooter } from '@/components/recent-lines-footer'

export default function ChatPage() {
  return (
    <ChatLayout sidebar={<RecentLinesFooter />}>
      <BranchingChatUI />
    </ChatLayout>
  )
}
```

### 4. レイアウトの再エクスポート

**ファイル**: `components/layouts/index.ts`
```typescript
export { PageLayout } from './PageLayout'
export { ChatLayout } from './ChatLayout'
```

### 5. 検証
- すべてのページが正常に表示されることを確認
- レスポンシブデザインが維持されることを確認
- `npm run cpd-check` でページ間重複が大幅に削減されることを確認

## 受け入れ条件
- [ ] `components/layouts/` ディレクトリが作成されている
- [ ] `PageLayout.tsx` と `ChatLayout.tsx` が実装されている
- [ ] 対象ページファイルが新しいレイアウトを使用している
- [ ] すべてのページが正常に表示される
- [ ] TypeScriptビルドが成功する
- [ ] jscpdでページ間重複が大幅に削減される

## 注意事項
- 既存のスタイリングを維持する
- ページ固有の機能を損なわない
- レスポンシブデザインを考慮する

## 優先度
Medium - 大きな影響範囲があるため慎重に実装

## 推定作業時間
90分

## 関連チケット
- #001: 共通型定義ファイル作成
- #002: 時間ユーティリティ関数共通化
- #004: UIパターン共通化