# Pipeline 1-3 テストレポート

**テストデータ**: messagees_sample.csv（50件）

---

## サマリー

| 指標 | 値 |
|------|-----|
| グループ数 | 16 |
| テスト対象 | 3グループ |
| 抽出Intent数 | 25 |
| メッセージ/Intent比率 | 0.82〜1.08 |
| 誤抽出 | 0件 |

---

## プロンプト改善

### 改善前後の比較

| 項目 | 改善前 | 改善後 |
|------|-------|-------|
| Intent数（20メッセージ） | 16 | 13 |
| 誤抽出 | 2件 | 0件 |
| 1メッセージ→複数Intent | 不可 | 可能 |
| 複数メッセージ→1Intent | 不可 | 可能 |
| メッセージ/Intent比率 | 固定（1:1） | 柔軟（0.82〜1.08） |

### 解決した問題
1. 1メッセージ→1Intentの固定的対応
2. ラベル・キーワードからの誤抽出

### 最終プロンプト

```python
# 抽出ルール
1. 1メッセージに複数の意図 → それぞれ別のIntentとして抽出
2. 複数メッセージで1つの意図 → 1つのIntentにまとめる
3. ラベル・タイトル・キーワードのみ → 除外
4. 具体的な行動・問題・提案が記述されているもののみ抽出

# 例1: 1メッセージ→2Intent
"検索機能を追加したい。あと通知も欲しい。"
→ [{"summary": "検索機能を追加したい"}, {"summary": "通知機能を追加したい"}]

# 例2: 2メッセージ→1Intent
メッセージ1: "ログイン画面の読み込みが遅い"
メッセージ2: "パフォーマンス改善が必要"
→ [{"summary": "ログイン画面のパフォーマンスを改善したい"}]

# 例3: 除外
"設定" → []
```

**ポイント**: テスト対象と異なる例を使用し、汎化能力を検証

---

## テスト結果

### グループごとの比率

| グループ | メッセージ | Intent | 比率 |
|---------|-----------|--------|------|
| group_000 | 13 | 14 | 1.08 |
| group_003 | 2 | 2 | 1.00 |
| group_004 | 11 | 9 | 0.82 |

### メッセージとIntentの対応（group_000の抜粋）

| 元のメッセージ | 抽出されたIntent | 評価 |
|---------------|-----------------|------|
| "ラインの要約" | *(抽出されない)* | ✅ 除外 |
| "直近使ってたラインの一覧という形で...フッターに出す？" | 1. 直近使っていたラインを一覧で表示したい<br>2. フッターのメニューをハンバーガーメニュー内へ移動させ、直近使っていたラインの候補をフッターに表示したい | ✅ 1→2 |
| "メモリもないので、ブランチ→チャット、の移動した時直近のラインに戻ってくることすらできない。これは直した方がいい" | ブランチからチャットへ移動した際、直近のラインに戻れるようにしたい | ✅ 適切 |
| "メッセージ修正したとき、ローカルのメッセージに更新がかかってない。データベースに反映してはいるみたいだけど。変更" | メッセージ修正時にローカルのメッセージにも更新を反映させたい | ✅ 適切 |
| "ドキュメントみたいなものと考えれば、フッターからさっとコンテキスト切り替えする...コンテキストスイッチのデザイン、のパターンを調べるかなあ" | 1. フッターから素早くコンテキストを切り替えられるようにしたい<br>2. コンテキストスイッチのデザインパターンを調べたい | ✅ 1→2 |
| "単純にデータベース更新アイコン" | *(抽出されない)* | ✅ 除外 |
| "タスクはタグだはなくメッセージタイプとして...統計など確認する画面にした方が多分いいな" | 1. タスクをメッセージ入力時にメッセージタイプとして選択できるようにしたい<br>2. メッセージタイプごとにまとめて統計などを確認できる画面を設けたい | ✅ 1→2 |

---

## 抽出されたIntent一覧

### group_000（13メッセージ → 14Intent）

1. 直近使っていたラインを一覧で表示したい
2. フッターのメニューをハンバーガーメニュー内へ移動させ、直近使っていたラインの候補をフッターに表示したい
3. ブランチからチャットへ移動した際、直近のラインに戻れるようにしたい
4. メッセージ修正時にローカルのメッセージにも更新を反映させたい
5. フッターから素早くコンテキストを切り替えられるようにしたい
6. コンテキストスイッチのデザインパターンを調べたい
7. タスクをメッセージ入力時にメッセージタイプとして選択できるようにしたい
8. メッセージタイプごとにまとめて統計などを確認できる画面を設けたい
9. メッセージ更新時のキャンセルボタンの位置を改善したい
10. 投稿タイプ（ブランチ↔︎メッセージ）を相互に変更できるようにしたい
11. ブランチ一覧からブランチが消えないようにしたい
12. ブランチ一覧の編集画面のテキストレイアウトを改善したい
13. メッセージの編集・削除アイコンと並べてライン移動アイコンを作成したい
14. ラインIDをMCPでコーディングエージェントなどに渡せるようにしたい

### group_003（2メッセージ → 2Intent）

1. サイドバーのブランチがフッターと異なる基準になっているか確認したい
2. 新しいメッセージ送信後、自動で一番下までスクロールする機能を実装したい

### group_004（11メッセージ → 9Intent）

1. システムメッセージとしてブランチの分岐情報（いつ別れたか）を表示したい
2. 思考の構造化をマインドマップ的な方法で可視化したい
3. メッセージに優先度別のタスクタグと完了情報を追加したい
4. 散らばっているLLMアプリのチャットメッセージをこのアプリに収束させたい
5. Claude Codeとのやりとり履歴を閲覧できるようにしたい
6. メッセージの編集ボタンを右上ではなく右下に表示したい
7. テキストのコピー機能を追加したい
8. スクリーンショット保存機能を追加したい
9. ポモドーロやタイマー機能として、ブランチに関連する活動のチェックイン/チェックアウトメッセージタイプを導入したい

---

## プロンプトエンジニアリングの知見

### 効果的なテクニック

1. **番号付きルールで構造化**
2. **テスト対象と異なる具体例**（汎化能力の検証）
3. **除外条件の明示**
4. **簡潔な記述**（冗長な説明を避ける）

### 結果

- メッセージ/Intent比率: 0.82〜1.08（柔軟に対応）
- 誤抽出: 0件
- 汎化能力: プロンプト例にない文章構造でも正しく分離
